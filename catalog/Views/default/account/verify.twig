{{ header }}
<div class="section gray padding-bottom-60 padding-top-60 full-width-carousel-fix">	
<div class="container">
	<div class="row">
		<div class="col-xl-5 offset-xl-3">
			<div class="login-register-page shadow p-3 mb-5 bg-white rounded">
				<!-- Welcome Text -->
				<div class="welcome-text">
					<h3>{{ heading_title }}</h3>
					<small>{{ help_verifiy }}</small>
				</div>
				<form method="post" action="" enctype="multipart/form-data" accept-charset="utf-8" id="form-access">
				<div class="form-group">
					<div class="input-group mb-3">
						<div class="input-group-prepend">
					    <span class="input-group-text"><i class="icon-material-outline-lock"></i></span>
					  </div>
						<input type="text" class="form-control" name="code" id="input-code" placeholder="{{ entry_code }}"/>
					</div>
				</div>
				<button class="button full-width button-sliding-icon ripple-effect margin-top-10" type="button" id="button-form-access">{{ button_verify }} <i class="icon-material-outline-arrow-right-alt"></i></button>
				</form>
			</div>
		</div>
	</div>
</div>
</div>
<script type="text/javascript">
	$('#button-form-access').on('click', function () {
		$.ajax({
			url: 'account/access/validateLogin',
			headers: {
				'X-CSRF-TOKEN': $('meta[name="{{ csrf_token() }}"]').attr('content'),
				'X-Requested-With': 'XMLHttpRequest',
				'Content-Type': 'application/x-www-form-urlencoded',
			},
			type: 'post',
			dataType: 'json',
			data: $('#form-access input[name=\'code\']'),
			beforeSend: function () {
				$('#login-wrapper').removeClass('animate__animated animate__shakeX');
				$('.form-group input').removeClass('is-invalid');
				$('.alert, .invalid-feedback').remove();
			},
			success: function (json) {
				if (json['error_warning']) {
					if (json['validator']) {
						for (i in json['validator']) {
							$('#input-' + i).after('<div class="invalid-feedback">' + json['validator']
								[i] + '</div>');
							$('#input-' + i).addClass('is-invalid');
						}
					}

					$('.welcome-text').before(
						'<div class="alert alert-danger fade show" role="alert"><i class="fas fa-exclamation-circle"></i> ' + json['error_warning'] + '<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>'
					);
					$('#login-wrapper').addClass('animate__animated animate__shakeX');
				}

				if (json['error_code']) {
					$('.welcome-text').before(
						'<div class="alert alert-danger fade show" role="alert"><i class="fas fa-exclamation-circle"></i> ' + json['error_code'] + '<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>'
					);
				}

				if (json['redirect']) {
					$('#login-wrapper').html(
						'<h2 class="text-center"><i class="fas fa-thumbs-up text-danger"></i> Login Success</h2><p class="text-center">Please wait we will redirect you.</p><div class="d-flex justify-content-center"><div class="spinner-border" role="status"><span class="sr-only">Loading...</span></div></div>'
					);
					setTimeout(function () {
						location = json['redirect'];
					}, 2000);
				}
			},
			error: function (xhr, ajaxOptions, thrownError) {
				alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
			}
		});
	});
</script>
{{ footer }}