<div class="table-responsive">
	<table class="table table-striped table-bordered w-100" id="table-freelancer-in-progress-tab">
		<thead>
			<tr>
				<th>{{ column_project_id }}</th>
				<th>{{ column_name }}</th>
				<th>{{ column_budget }}</th>
				<th>{{ column_type }}</th>
				<th>{{ column_status }}</th>
				<th>{{ column_action }}</th>
			</tr>
			</tr>
		</thead>
		<tbody>
			{% if projects %}
			{% for project in projects %}
			<tr>
				<td>{{ project.project_id }}</td>
				<td>{{ project.name }}</td>
				<td>{{ project.budget }}</td>
				<td>{{ project.type }}</td>
				<td>{{ project.status }}</td>
				<td><a href="{{ project.view }}" class="btn btn-primary btn-sm" data-toggle="tooltip"
						data-placement="top" title="view"><i class="far fa-eye"></i></a>
					{% if project.status_id != config_project_completed_status %}
					<button type="button"
						onclick="markComeplete({{ project.project_id }}, {{ project.freelancer_id }}, {{ project.employer_id }});"
						class="btn btn-success btn-sm" data-toggle="tooltip" data-placement="top"
						title="Mark As Complete" id="button-complete-status"><i class="fas fa-check"></i></button>
					{% else %}
					<button type="button" class="btn btn-success btn-sm" data-toggle="tooltip" data-placement="top"
						title="Mark As Complete" id="button-complete-status" disabled><i
							class="fas fa-check"></i></button>
					{% endif %}
				</td>
			</tr>
			{% endfor %}
			{% endif %}
		</tbody>
	</table>
</div>
<link rel="stylesheet" href="catalog/default/vendor/DataTables/datatables.css" media="all" type="text/css" />
<script src="catalog/default/vendor/DataTables/datatables.min.js" type="text/javascript"></script>
<script type="text/javascript">
	$('#table-freelancer-in-progress-tab').DataTable({
		"lengthMenu": [10, 20, 30],
	});
</script>
<!-- Freelancer to complete project  -->
<script type="text/javascript">
function markComeplete(project_id, freelancer_id, employer_id) {
	bootbox.confirm({
	message: "Are you sure?",
	size: 'small',
	className: 'animate__animated animate__fadeInDown',
	buttons: {
	    cancel: {
	        label: '<i class="fa fa-times"></i> Cancel',
	        className: 'btn-dark'
	    },
	    confirm: {
	        label: '<i class="fa fa-check"></i> Confirm',
	        className: 'btn-success'
	    }
	},
	callback: function (result) {
	if (result) {
		$.ajax({
		url: 'freelancer/project/completeProject?project_id=' + project_id,
		headers: {
          'X-CSRF-TOKEN': $('meta[name="<?= csrf_token() ?>"]').attr('content')
        },
		dataType: 'json',
		method: 'post',
		data: {'freelancer_id': freelancer_id, 'employer_id': employer_id},
		beforeSend: function() {
	       $('#button-complete-status').html(' <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Loading...');
	       $('.alert').remove();
	    },
	    complete: function() {
	       $('#button-complete-status').html('<i class="fas fa-check"></i>');
	    },
	    success: function(json) {

	        if (json['success']) {
	        	
	        	$('#freelancer-in-progress').before('<div class="alert alert-success alert-dismissible fade show" role="alert"><i class="fas fa-check-circle"></i> ' + json['success'] + '<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>');
	        	
	        	$('#freelancer-progress-list').load('freelancer/Project/getInProgressProjects');   
	        }
	    },
	    error: function(xhr, ajaxOptions, thrownError) {
	        alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
	    }
         });
      } 
    } 
   });  
}
</script>